{"version":3,"file":"gtmLoader.js","names":["GoogleTagManagerLoader","_ref","config","_classCallCheck","gtmId","GOOGLE_TAG_MANAGER_ID","gtmArgs","GOOGLE_TAG_MANAGER_ENVIRONMENT","startsWith","_createClass","key","value","loadScript","global","googleTagManager","_global","invoked","load","args","options","scriptSrc","document","createElement","type","async","innerHTML","concat","head","insertBefore","getElementsByTagName","_loadOptions","noScriptSrc","body","childNodes"],"sources":["../../src/services/gtmLoader.js"],"sourcesContent":["/**\n * @implements {GoogleTagManagerLoader}\n * @memberof module:GoogleTagManager\n */\nclass GoogleTagManagerLoader {\n  constructor({ config }) {\n    this.gtmId = config.GOOGLE_TAG_MANAGER_ID;\n\n    this.gtmArgs = '';\n    if (config.GOOGLE_TAG_MANAGER_ENVIRONMENT) {\n      if (!config.GOOGLE_TAG_MANAGER_ENVIRONMENT.startsWith('&')) {\n        this.gtmArgs += '&';\n      }\n      this.gtmArgs += config.GOOGLE_TAG_MANAGER_ENVIRONMENT;\n    }\n  }\n\n  loadScript() {\n    if (!this.gtmId) {\n      return;\n    }\n\n    global.googleTagManager = global.googleTagManager || [];\n    const { googleTagManager } = global;\n\n    // If the snippet was invoked do nothing.\n    if (googleTagManager.invoked) {\n      return;\n    }\n\n    // Invoked flag, to make sure the snippet is never invoked twice.\n    googleTagManager.invoked = true;\n\n    googleTagManager.load = (key, args, options) => {\n      const scriptSrc = document.createElement('script');\n      scriptSrc.type = 'text/javascript';\n      scriptSrc.async = true;\n      scriptSrc.innerHTML = `\n      (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n       new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n       j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n       'https://www.googletagmanager.com/gtm.js?id='+i+dl+'${args}';f.parentNode.insertBefore(j,f);       \n       })(window,document,'script','dataLayer','${key}');\n      `;\n      document.head.insertBefore(scriptSrc, document.head.getElementsByTagName('script')[0]);\n\n      googleTagManager._loadOptions = options; // eslint-disable-line no-underscore-dangle\n\n      const noScriptSrc = document.createElement('noscript');\n\n      noScriptSrc.innerHTML = `\n      <iframe src=\"https://www.googletagmanager.com/ns.html?id=${key} height=\"0\" width=\"0\" style=\"display:none;visibility:hidden\"></iframe>\n      `;\n      document.body.insertBefore(noScriptSrc, document.body.childNodes[0]);\n    };\n\n    // Load GoogleTagManager with your key.\n    googleTagManager.load(this.gtmId, this.gtmArgs);\n  }\n}\n\nexport default GoogleTagManagerLoader;\n"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAHA,IAIMA,sBAAsB;EAC1B,SAAAA,uBAAAC,IAAA,EAAwB;IAAA,IAAVC,MAAM,GAAAD,IAAA,CAANC,MAAM;IAAAC,eAAA,OAAAH,sBAAA;IAClB,IAAI,CAACI,KAAK,GAAGF,MAAM,CAACG,qBAAqB;IAEzC,IAAI,CAACC,OAAO,GAAG,EAAE;IACjB,IAAIJ,MAAM,CAACK,8BAA8B,EAAE;MACzC,IAAI,CAACL,MAAM,CAACK,8BAA8B,CAACC,UAAU,CAAC,GAAG,CAAC,EAAE;QAC1D,IAAI,CAACF,OAAO,IAAI,GAAG;MACrB;MACA,IAAI,CAACA,OAAO,IAAIJ,MAAM,CAACK,8BAA8B;IACvD;EACF;EAACE,YAAA,CAAAT,sBAAA;IAAAU,GAAA;IAAAC,KAAA,EAED,SAAAC,WAAA,EAAa;MACX,IAAI,CAAC,IAAI,CAACR,KAAK,EAAE;QACf;MACF;MAEAS,MAAM,CAACC,gBAAgB,GAAGD,MAAM,CAACC,gBAAgB,IAAI,EAAE;MACvD,IAAAC,OAAA,GAA6BF,MAAM;QAA3BC,gBAAgB,GAAAC,OAAA,CAAhBD,gBAAgB;;MAExB;MACA,IAAIA,gBAAgB,CAACE,OAAO,EAAE;QAC5B;MACF;;MAEA;MACAF,gBAAgB,CAACE,OAAO,GAAG,IAAI;MAE/BF,gBAAgB,CAACG,IAAI,GAAG,UAACP,GAAG,EAAEQ,IAAI,EAAEC,OAAO,EAAK;QAC9C,IAAMC,SAAS,GAAGC,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;QAClDF,SAAS,CAACG,IAAI,GAAG,iBAAiB;QAClCH,SAAS,CAACI,KAAK,GAAG,IAAI;QACtBJ,SAAS,CAACK,SAAS,qSAAAC,MAAA,CAIoCR,IAAI,gGAAAQ,MAAA,CACfhB,GAAG,gBAC9C;QACDW,QAAQ,CAACM,IAAI,CAACC,YAAY,CAACR,SAAS,EAAEC,QAAQ,CAACM,IAAI,CAACE,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QAEtFf,gBAAgB,CAACgB,YAAY,GAAGX,OAAO,CAAC,CAAC;;QAEzC,IAAMY,WAAW,GAAGV,QAAQ,CAACC,aAAa,CAAC,UAAU,CAAC;QAEtDS,WAAW,CAACN,SAAS,wEAAAC,MAAA,CACsChB,GAAG,yFAC7D;QACDW,QAAQ,CAACW,IAAI,CAACJ,YAAY,CAACG,WAAW,EAAEV,QAAQ,CAACW,IAAI,CAACC,UAAU,CAAC,CAAC,CAAC,CAAC;MACtE,CAAC;;MAED;MACAnB,gBAAgB,CAACG,IAAI,CAAC,IAAI,CAACb,KAAK,EAAE,IAAI,CAACE,OAAO,CAAC;IACjD;EAAC;EAAA,OAAAN,sBAAA;AAAA;AAGH,eAAeA,sBAAsB","ignoreList":[]}